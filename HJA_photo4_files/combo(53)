YUI.add("photo-selector-view",function(t,e){var o=require("hermes-core/flog")(e),i={};i={horizontal:20,vertical:20},t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return""===this.get("container").getHTML()&&this.setContainerWithTemplate("flickr-balls"),this.photoListView,this.searchPhotoListViews=[],this.publicOnlyGroups=t.publicOnlyGroups,this.publicOnlyPhotos=t.publicOnlyPhotos,this.enableMultiSelect=t.enableMultiSelect||!1,this.multiSelectLimit=void 0===t.multiSelectLimit?1:t.multiSelectLimit,this.preSelectedPhotos=t.preSelectedPhotos||[],this.clearRegistriesOnDestroy=t.clearRegistriesOnDestroy||!1,this.selectedModels=[],t.enableVideos&&this.set("itemFilterFunction",!1),this.isUploading=!1,this},loadState:function(){var e=this.appContext.getViewer().nsid;return this.publicOnlyPhotos&&(e+="-public"),this.appContext.getModelRegistry("profile-selected-photos-models").then(function(o){o.removeAll();var i={selectionModel:this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid),photostreamModel:this.appContext.getModel("photostream-models",e,this.publicOnlyPhotos?{viewAs:"public"}:void 0),setModelRegistry:this.appContext.getModelRegistry("set-models"),setsModel:this.appContext.getModel("sets-models",this.appContext.getViewer().nsid,{page:1,perPage:25}),profileModel:this.appContext.getModel("person-profile-models",this.appContext.getViewer().nsid)};return new t.FlickrPromise(i).then(this.onLoadStateResolved.bind(this))}.bind(this))},onLoadStateResolved:function(e){if(this.set("selectionModel",e.selectionModel),this.set("photostreamModel",e.photostreamModel),this.set("setsModel",e.setsModel),this.set("setModelRegistry",e.setModelRegistry),this.set("profileModel",e.profileModel),this.preSelectedPhotos&&this.preSelectedPhotos.length>0&&this.get("selectionModel").setValue("photos",this.preSelectedPhotos?this.preSelectedPhotos:[]),0===this.get("photostreamModel").getValue("totalItems")?this.set("photostreamEmpty",!0):this.set("photostreamEmpty",!1),this.get("groupId"))return this.appContext.getModel("group-pool-models",this.get("groupId")).then(function(t){this.set("groupModel",t)}.bind(this),function(t){o.error("error loading group model",{err:t})});this.canUpload=this.get("hasUploadCapabilities")&&!t.UserLimitsHelper.hasReachedUploadLimit(this.get("profileModel"),this.appContext)},moveElementToFirstInArray:function(t,e,o){var i;return t.forEach(function(t,s){t[o]===e&&(i=s)}),t.unshift(t.splice(i,1)[0]),t},buildContainer:function(){return this.setContainerWithTemplate("photo-selector",{hasUploadCapabilities:this.get("hasUploadCapabilities"),canUpload:this.canUpload,searchable:this.get("searchable"),publicOnlyPhotos:this.get("publicOnlyPhotos"),photostreamEmpty:this.get("photostreamEmpty"),hasGroupCapabilities:this.get("groupId")}),this},loadPhotoList:function(e,s){var a,r=this,l=this.get("container"),n=l.one(".photo-selector-photos-wrapper");this.photoListView&&this.photoListView.destroy(),s||(s=!1),a={modelParams:e,fetchParams:e.fetchParams,parentName:this.name,hasMultiSelect:this.enableMultiSelect,multiSelectLimit:this.multiSelectLimit,paginateOnScroll:!0,parentContainer:n,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName"),galleryId:this.get("galleryId"),type:this.get("defaultSelected").type},this.get("itemFilterFunction")&&(a.itemFilterFunction=this.get("itemFilterFunction")),a.layout={targetRowHeight:150,containerWidth:a.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:i,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:n.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=a,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:a,isActiveViewAgnostic:!0,container:l.one(".photo-selector-photos-container")}).then(function(e){return e.initialize().then(function(e){var o,i=l.one(".photo-selector-photos-container"),a=i.one(".photo-list-view"),h=l.one(".loader");n.getDOMNode().scrollTop=0,r.photoListView=e,h&&h.addClass("loaded"),a.hasChildNodes()||(o=s?t.Node.create('<p class="no-results">'+r.intlMessage({intlName:"search.NO_MATCHES_FOR_QUERY_TERM_YOUR"})+"</p>"):r.publicOnlyPhotos?t.Node.create('<p class="no-results">'+r.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PUBLIC_PHOTOS"})+"</p>"):t.Node.create('<p class="no-results">'+r.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PHOTOS"})+"</p>"),a.empty(),i.prepend(o)),r.addPhotoToSelection(null)})},function(t){o.error("Error getting view",{err:t})})},loadSelectionPhotoList:function(){var e,s=this,a=this.get("container"),r=a.one(".photo-selector-photos-wrapper");this.photoListView&&this.photoListView.destroy(),(e={parentName:this.name,hasMultiSelect:this.enableMultiSelect,multiSelectLimit:this.multiSelectLimit,paginateOnScroll:!0,initialItems:this.get("selectionModel").getValue("photos").getList(),parentContainer:r,relayoutOnResize:!0,interactionViewName:"photo-selector-selection-interaction-view"}).layout={targetRowHeight:150,containerWidth:e.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:i,forceAspectRatio:1,alwaysDisplayOrphans:!0,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:r.get("offsetHeight")},this.get("itemFilterFunction")&&(e.itemFilterFunction=this.get("itemFilterFunction")),this.appContext.params.primaryPhotoListConfig=e,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:e,isActiveViewAgnostic:!0,nsid:this.appContext.getViewer().nsid,container:a.one(".photo-selector-photos-container")}).then(function(e){return e.initialize().then(function(e){var o,i=a.one(".photo-selector-photos-container"),l=i.one(".photo-list-view"),n=a.one(".loader");i.addClass("photo-selector-selection-photolist"),r.getDOMNode().scrollTop=0,s.photoListView=e,n&&n.addClass("loaded"),l.hasChildNodes()||(o=t.Node.create('<p class="no-results">'+s.intlMessage({intlName:"profile.NO_PHOTOS_SELECTED"})+"</p>"),l.empty(),i.prepend(o))})},function(t){o.error("Error getting view",{err:t})})},loadGroupPhotoList:function(e){var s,a=this,r=this.get("container"),l=r.one(".group-photo-selector-photos-wrapper");this.photoListView&&this.photoListView.destroy(),s={modelParams:e,parentName:this.name,paginateOnScroll:!0,parentContainer:l,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName")},this.get("itemFilterFunction")&&(s.itemFilterFunction=this.get("itemFilterFunction")),s.layout={targetRowHeight:150,containerWidth:s.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:i,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:l.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=s,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:s,isActiveViewAgnostic:!0,container:l}).then(function(e){return e.initialize().then(function(e){var o,i=r.one(".group-photo-selector-photos-container"),s=i.one(".photo-list-view");l.getDOMNode().scrollTop=0,a.photoListView=e,r.one(".loader").addClass("loaded"),s.hasChildNodes()||(o=t.Node.create('<p class="no-results">'+a.intlMessage({intlName:"groups.GROUP_POOL_CONTAINS_NO_PUBLIC_PHOTOS"})+"</p>"),s.empty(),i.prepend(o)),a.addPhotoToSelection(null)})},function(t){o.error("Error getting view",{err:t})})},loadSetsPhotoList:function(t){var e,s=this,a=this.get("container");this.photoListView&&this.photoListView.destroy(),(e={modelParams:t,parentName:this.name,paginateOnScroll:!0,parentContainer:a.one(".photo-selector-photos-wrapper"),relayoutOnResize:!0,interactionViewName:this.get("setsInteractionViewName"),engagementModelName:"set-models",viewBeaconRestrictedAttribute:"primaryNeedsInterstitial"}).layout={targetRowHeight:200,containerWidth:e.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:20,bottom:10,left:20},itemSpacing:i,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:a.one(".photo-selector-photos-wrapper").get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=e,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:e,isActiveViewAgnostic:!0,container:a.one(".photo-selector-photos-container")}).then(function(t){return t.initialize().then(function(t){var e=a.one(".loader");a.one(".photo-selector-photos-container .photo-list-view");a.one(".photo-selector-photos-wrapper").getDOMNode().scrollTop=0,s.photoListView=t,e&&a.one(".loader").addClass("loaded"),s.addPhotoToSelection(null)})},function(t){o.error("Error getting view",{err:t})})},loadSearchPhotoList:function(t){var e,s=this,a=this.get("container"),r=t.photoListContainerSelector?a.one(t.photoListContainerSelector):a.one(".photo-selector-photos-container"),l=t.parentContainerSelector?a.one(t.parentContainerSelector):a.one(".photo-selector-photos-wrapper"),n=t.maxNumRows?this.get("limitedRowsPhotoListViewName"):this.get("photoListViewName");this.searchPhotoListViews&&this.searchPhotoListViews[t.listId]&&this.searchPhotoListViews[t.listId].destroy(),e={modelParams:t.modelParams,parentName:this.name,paginateOnScroll:!0,parentContainer:l,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName"),engagementModelName:"photo-lite-models"},this.get("itemFilterFunction")&&(e.itemFilterFunction=this.get("itemFilterFunction")),e.layout={targetRowHeight:150,containerWidth:e.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:0,bottom:10,left:0},itemSpacing:i,forceAspectRatio:1,maxNumRows:t.maxNumRows?t.maxNumRows:Number.POSITIVE_INFINITY,alwaysDisplayOrphans:!!t.alwaysDisplayOrphans&&t.alwaysDisplayOrphans,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:l.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=e,this.appContext.getView(n,{appContext:this.appContext,publicOnlyPhotos:this.publicOnlyPhotos,primaryPhotoListConfig:e,isActiveViewAgnostic:!0,container:r,searchUrl:t.searchUrl,listId:t.listId}).then(function(e){return e.initialize().then(function(e){s.registerEventHandler(e.on("subviewViewEvent",s.handleSubviewEvent,s)),a.one(".photo-selector-search-lists-wrapper").getDOMNode().scrollTop=0,t.parentContainerSelector&&(a.one(t.parentContainerSelector).getDOMNode().scrollTop=0),s.searchPhotoListViews[t.listId]=e,a.one(".loader").addClass("loaded"),s.addPhotoToSelection(null)})},function(t){o.error("Error getting view",{err:t})})},activate:function(){var e,o=this.get("container"),i=this.get("defaultSelected");return this.registerEventHandler(o.on("click",this.handleClick,this)),this.canUpload&&this.registerEventHandler(o.one(".file-select").on("change",this.handleFileSelect,this)),this.registerEventHandler(t.on("photoSelector:subviewEvent",this.handleSubviewEvent,this)),i?"group"===i.type?(e={registryName:"group-pool-models",modelIdOrAttributes:this.get("groupId")+"-public",collectionAttributeName:"photoPageList"},this.publicOnlyGroups&&(e.fetchParams={privacyFilter:1},e.modelIdOrAttributes+="-public"),this.toggleGroupSelector(),this.loadGroupPhotoList(e),this.toggleTitleBar(i.title,"group")):"gallery"===i.type?(e={registryName:"gallery-info-models",modelIdOrAttributes:i.id,collectionAttributeName:"photoList"},this.loadPhotoList(e)):"galleryFaves"===i.type?(e={registryName:"gallery-faves-models",modelIdOrAttributes:this.get("defaultSelected").id,collectionAttributeName:"photoList",fetchParams:{galleryId:this.get("galleryId")}},this.loadPhotoList(e)):(e={registryName:"set-models",modelIdOrAttributes:this.publicOnlyPhotos?i.id+"-public":i.id,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(e.fetchParams={filter:1}),this.loadPhotoList(e),this.toggleTitleBar(i.title,"set")):0===this.get("photostreamModel").getValue("totalItems")?this.get("hasUploadCapabilities")?(this.toggleUploader(),this.hideTitleBar()):this.toggleTitleBar(this.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PUBLIC_PHOTOS"},"empty",!1)):(e={registryName:"photostream-models",modelIdOrAttributes:this.publicOnlyPhotos?this.appContext.getViewer().nsid+"-public":this.appContext.getViewer().nsid,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(e.fetchParams={viewAs:"public"}),this.loadPhotoList(e,!1)),this},toggleUploader:function(){this.get("hasUploadCapabilities")&&(this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("container").one(".photo-selector-photos-container").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-upload").removeClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding"))},toggleSelector:function(){this.get("hasUploadCapabilities")&&this.get("container").one(".photo-selector-upload").addClass("is-hiding"),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").removeClass("is-hiding")},toggleSearchListsSelector:function(){this.get("hasUploadCapabilities")&&this.get("container").one(".photo-selector-upload").addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("container").one(".photo-selector-photos-container").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").removeClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding")},toggleGroupSelector:function(){var t=this.get("container").one(".photo-selector-upload");t&&t.addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").removeClass("is-hiding")},toggleTitleBar:function(e,o,i){var s=this.get("container"),a=s.one(".photo-selector-title-bar"),r=a.one(".back-to-list"),l="";void 0===i&&(i=!0),"search"===o&&e&&(e='"'+e+'"'),"set"===o?l=this.intlMessage({intlName:"common.PHOTO_SELECTOR_BACK_TO_ALBUM_LIST"}):"search"===o&&(l=this.intlMessage({intlName:"common.PHOTO_SELECTOR_BACK_TO_SEARCH_LIST"})),i?r.removeClass("hidden"):r.addClass("hidden"),r.one(".back-to-list-text").set("text",l),a.one(".title").set("text",t.Handlebars.helpers.truncate(e,120)),a.removeClass("hidden"),s.one(".photo-selector-photos-wrapper").addClass("showing-title"),s.one(".photo-selector-search-lists-wrapper").addClass("showing-title"),this.get("groupId")&&s.one(".group-photo-selector-photos-wrapper").addClass("showing-title")},hideTitleBar:function(){var t=this.get("container");t.one(".photo-selector-title-bar").addClass("hidden"),t.one(".photo-selector-photos-wrapper").removeClass("showing-title"),this.get("groupId")&&t.one(".group-photo-selector-photos-wrapper").removeClass("showing-title")},onParentViewEvent:function(e,o){var i,s,a,r=o[1],l={},n=this.get("searchable"),h=this.get("container").one(".no-results");if("navigation"===o[0])if("upload"===(i=r.target._node.dataset.value))this.get("hasUploadCapabilities")&&(this.toggleUploader(),this.hideTitleBar()),this.get("fileDragDrop")?this.get("fileDragDrop").reset():this.canUpload&&(this.set("fileDragDrop",new t.HtmlFileDragDrop({dropZone:".photo-selector-upload > .drop-zone"})),this.get("fileDragDrop").on("drop",this.handleFileDrop,this));else{if(this.get("hasUploadCapabilities")&&this.toggleSelector(),"group"===i)s={registryName:"group-pool-models",modelIdOrAttributes:this.get("groupId"),collectionAttributeName:"photoPageList"},this.publicOnlyGroups&&(s.fetchParams={privacyFilter:1},s.modelIdOrAttributes+="-public"),this.toggleGroupSelector(),this.loadGroupPhotoList(s);else if("photostream"===i){if(0===this.get("photostreamModel").getValue("totalItems"))return h&&h.remove(),void(this.get("hasUploadCapabilities")?(this.toggleUploader(),this.hideTitleBar()):this.toggleTitleBar(this.intlMessage({intlName:"common.PHOTO_SELECTOR_EMPTY_PUBLIC_PHOTOS"},"empty",!1)));s={registryName:"photostream-models",modelIdOrAttributes:this.publicOnlyPhotos?this.appContext.getViewer().nsid+"-public":this.appContext.getViewer().nsid,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(s.fetchParams={viewAs:"public"}),this.loadPhotoList(s)}else if("sets"===i){if(0===this.get("setsModel").getValue("totalItems")){var p=this.get("container").one(".photo-list-view");return h&&h.remove(),this.toggleTitleBar(this.intlMessage({intlName:"common.PHOTO_SELECTOR_NO_ALBUMS"},"empty",!1)),void p.empty()}s={registryName:"sets-models",modelIdOrAttributes:this.appContext.getViewer().nsid,collectionAttributeName:"albumsList"},this.loadSetsPhotoList(s)}else"gallery"===i?(s={registryName:"gallery-info-models",modelIdOrAttributes:this.get("galleryId"),collectionAttributeName:"photoList"},this.loadPhotoList(s)):"galleryFaves"===i?(s={registryName:"gallery-faves-models",modelIdOrAttributes:this.get("defaultSelected").id,collectionAttributeName:"photoList",fetchParams:{galleryId:this.get("galleryId")}},this.loadPhotoList(s)):this.loadSelectionPhotoList();this.hideTitleBar()}else"search"===o[0]&&(a=new t.SearchUrl(r.apiParams,this.appContext),this.toggleSearchListsSelector(),n.yours&&(this.searchUrlYourPhotos=new t.SearchUrl(r.apiParams,this.appContext),this.searchUrlYourPhotos.setAPIParam("user_id",this.appContext.getViewer().nsid),n.contacts||n.everyone?(l.listId="yours",l.photoListContainerSelector=".photo-selector-search-list-yours .photo-selector-search-list-container",l.parentContainerSelector=".photo-selector-search-list-yours",l.maxNumRows=1,l.alwaysDisplayOrphans=!0,l.searchUrl=this.searchUrlYourPhotos,l.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlYourPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlYourPhotos.getAPIParams()}},this.publicOnlyPhotos&&(s.fetchParams.privacyFilter=1),this.loadSearchPhotoList(l)):(this.toggleSelector(),s={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlYourPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlYourPhotos.getAPIParams(),additionalExtras:["o_dims"]}},this.publicOnlyPhotos&&(s.fetchParams.privacyFilter=1),this.loadPhotoList(s,!0))),n.contacts&&(this.searchUrlContactsPhotos=new t.SearchUrl(r.apiParams,this.appContext),this.searchUrlContactsPhotos.setAPIParam("user_id",this.appContext.getViewer().nsid),this.searchUrlContactsPhotos.setAPIParam("contacts","all"),l.listId="contacts",l.photoListContainerSelector=".photo-selector-search-list-contacts .photo-selector-search-list-container",l.parentContainerSelector=".photo-selector-search-list-contacts",l.maxNumRows=1,l.alwaysDisplayOrphans=!0,l.searchUrl=this.searchUrlContactsPhotos,l.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlContactsPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlContactsPhotos.getAPIParams()}},this.loadSearchPhotoList(l)),n.everyone&&(this.searchUrlEveryonePhotos=new t.SearchUrl(r.apiParams,this.appContext),l.listId="everyone",l.photoListContainerSelector=".photo-selector-search-list-everyone .photo-selector-search-list-container",l.parentContainerSelector=".photo-selector-search-list-everyone",l.maxNumRows=1,l.alwaysDisplayOrphans=!0,l.searchUrl=this.searchUrlEveryonePhotos,l.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:r.id,collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlEveryonePhotos.getAPIParams()}},this.loadSearchPhotoList(l)),this.toggleTitleBar(a.getAPIParams().text,"search",!1))},handleSubviewEvent:function(e){var o,i,s;return"selectPhotoFromPhotoList"===e.eventName?(o={photoModel:this.appContext.getModel("photo-models",e.id)},new t.FlickrPromise(o).then(function(t){t.photoModel.isOwner&&this.set("photoSource",this.get("photoSourceOwnImage")),this.enableMultiSelect&&this.hasReachMultiSelectLimit()||this.addPhotoToSelection(t.photoModel.id,t.photoModel)}.bind(this))):"unselectPhotoFromPhotoList"===e.eventName?(o={photoModel:this.appContext.getModel("photo-models",e.id)},new t.FlickrPromise(o).then(function(t){t.photoModel.isOwner&&this.set("photoSource",this.get("photoSourceOwnImage")),this.removePhotoFromSelection(t.photoModel.id,t.photoModel)}.bind(this))):"selection:remove"===e.eventName?(o={photoModel:this.appContext.getModel("photo-models",e.model.getValue("id"))},new t.FlickrPromise(o).then(function(t){t.photoModel.isOwner&&this.set("photoSource",this.get("photoSourceOwnImage")),this.removePhotoFromSelection(t.photoModel.id,t.photoModel,!0)}.bind(this))):void("selectSetFromPhotoList"===e.eventName?(i={registryName:"set-models",modelIdOrAttributes:this.publicOnlyPhotos?e.id+"-public":e.id,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(i.fetchParams={filter:1}),this.loadPhotoList(i,!1),this.toggleTitleBar(e.title,"set")):e.details&&"viewEntireSearchList"===e.details[0]&&(i={registryName:"search-photos-lite-models",modelIdOrAttributes:e.details[1].searchUrl.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:e.details[1].searchUrl.getAPIParams()}},this.publicOnlyPhotos&&(i.fetchParams.privacyFilter=1),this.toggleSelector(),this.loadPhotoList(i),s="search.YOUR_PHOTOS","contacts"===e.details[1].list?s="search.FROM_YOUR_CONTACTS":"everyone"===e.details[1].list&&(s="search.EVERYONES_PHOTOS"),s=this.intlMessage({intlName:s}),this.toggleTitleBar(s+": "+e.details[1].searchUrl.getAPIParams().text,"search")))},handleClick:function(t){var e=t.target;this.isUploading||(e.ancestor(".back-to-list",!0)?this.fire("subviewViewEvent","backToList"):e.ancestor(".simulate-file-select",!0)&&(t.halt(),this.get("container").one(".file-select").set("value",""),this.get("container").one(".file-select").getDOMNode().click()))},handleSelectPhoto:function(e){var o;if(o={photoModel:this.appContext.getModel("photo-models",e.getData("photo-id"))},!e.hasClass("invalid"))return this.set("photoSource",this.get("photoSourceOwnImage")),new t.FlickrPromise(o).then(function(t){this.addPhotoToSelection(t.photoModel.id,t.photoModel)}.bind(this))},hasReachMultiSelectLimit:function(){return this.get("selectionModel").getValue("photos").size()===this.multiSelectLimit},addPhotoToSelection:function(e,o){if(null===e)this.set("selected",null),t.fire("photoSelector:unselected");else if(e&&this.enableMultiSelect){var i=this.get("selectionModel").getValue("photos");this.hasReachMultiSelectLimit()||i.find(o)||(i.push(o),t.fire("photoSelector:selected",{hasWarning:!1,photoId:e}),this.updateSelectCountText(i.size()))}else e&&(this.set("selected",e),t.fire("photoSelector:selected",{hasWarning:!1,photoId:e}))},updateSelectCountText:function(e){var o=this.multiSelectLimit-e;t.fire("photoSelector:updateCount",{count:o})},removePhotoFromSelection:function(e,o,i){var s=this.get("selectionModel").getValue("photos");if(s.find(o)){s.removeFromList(e)&&(t.fire("photoSelector:unselected",{hasWarning:!1,photoId:e,wasLastPhotoSelected:0===s.size()}),this.updateSelectCountText(s.size()),i&&this.loadSelectionPhotoList())}},handlePhotoSetSelector:function(t){var e;this.get("hasUploadCapabilities")&&this.toggleSelector(),e={registryName:"set-models",modelIdOrAttributes:this.publicOnlyPhotos?t+"-public":t,collectionAttributeName:"photoPageList"},this.publicOnlyPhotos&&(e.fetchParams={filter:1}),this.loadPhotoList(e)},handlePhotoUploaded:function(t){this.appContext.getModelRegistry("photostream-models").then(function(e){e.attributeSearch({normalizedId:this.appContext.getViewer().nsid},!0).forEach(function(t){e.remove(t)}),this.addPhotoToSelection(t.id,t),this.fire("actionClick",t),this.resetUploader()}.bind(this),function(t){this.appContext.err(t)}.bind(this))},handleFileSelect:function(t){var e;(e=t.target.getDOMNode().files[0])&&e.name&&this.uploadFile(e)},pollTicket:function(e){if(this.uploadTimer){if(t.moment().diff(this.uploadTimer,"seconds")>this.get("maxUploadTimeAllowed"))return this.showUploadError("GENERIC")}else this.uploadTimer=t.moment();this.appContext.callAPI("flickr.photos.upload.checkTickets",{tickets:e}).then(function(t){var o;t&&t.stat&&("ok"!==t.stat&&this.showUploadError("GENERIC"),t.uploader&&t.uploader.ticket instanceof Array&&(o=t.uploader.ticket[0])&&o.id===e&&(1===o.complete?this.appContext.getModel("photo-models",o.photoid).then(this.handlePhotoUploaded.bind(this),function(t){this.showUploadError("GENERIC")}):2===o.complete?this.showUploadError("FILE_TYPE"):setTimeout(function(){this.pollTicket(e)}.bind(this),1e3)))}.bind(this),function(t){this.showUploadError("GENERIC")}.bind(this))},resetUploader:function(){this.clearUploadError(),this.get("container").one(".drop-zone").removeClass("uploading"),this.get("container").removeClass("uploading"),this.isUploading=!1,this.uploadTimer=void 0},uploadFile:function(e){var i,s,a,r=new FormData,l=t.config.flickr.api.hostname_client_upload;this.clearUploadError(),this.get("container").one(".drop-zone").addClass("uploading"),this.get("container").addClass("uploading"),this.isUploading=!0,r.append("api_key",t.config.flickr.api.site_key),r.append("csrf",t.config.flickr.csrf.token),r.append("photo",e,e.name),r.append("async","1"),r.append("is_public","0"),r.append("is_friend","0"),r.append("is_family","0"),r.append("content_type","1"),(i=this._imgFileXhr=new XMLHttpRequest).open("POST",l,!0),i.withCredentials=!0,s=function(t){var e="object"==typeof t?t.target.statusText:t+"";o.error("Error during upload",{statusText:e}),this.resetUploader(),this.showUploadError("GENERIC")},a=function(e){var o,i,a,r;try{r=t.one(e.currentTarget.responseXML),i=r.one("rsp").getAttribute("stat")}catch(t){i="",o=""}return"ok"!==i?s((i||"empty")+": "+(o||"no message")):(a=r.one("ticketid").get("text"),this.pollTicket(a))},i.addEventListener("load",a.bind(this)),i.addEventListener("error",s.bind(this)),i.send(r)},clearUploadError:function(){this.get("container").one(".upload-error").setHTML("")},showUploadError:function(t){this.resetUploader(),this.get("container").one(".upload-error").setHTML(this.intlMessage({intlName:this.get("errorMessages")[t]})),this.get("fileDragDrop").showError()},handleFileDrop:function(t){this.isUploading||(t instanceof Error?this.showUploadError(t.message):this.uploadFile(t))},destructor:function(){this.photoListView&&this.photoListView.destroy()}},{ATTRS:{maxUploadTimeAllowed:{readOnly:!0,value:20},errorMessages:{readOnly:!0,value:{GENERIC:"common.PHOTO_SELECTOR_ERROR_MESSAGE_GENERIC",FILE_TYPE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_TYPE",FILE_SIZE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_SIZE",FILE_COUNT:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_COUNT",LOW_QUALITY:"common.PHOTO_SELECTOR_ERROR_MESSAGE_LOW_QUALITY",COLOR_SPACE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_COLOR_SPACE"}},photoSourceOwnImage:{readOnly:!0,value:1},hasUploadCapabilities:{value:!0},photoListViewName:{value:"photo-selector-photolist-view"},limitedRowsPhotoListViewName:{value:"photo-selector-limited-rows-photolist-view"},searchable:{value:{yours:!0,contacts:!0,everyone:!0}},interactionViewName:{value:"photo-selector-photolist-interaction-view"},setsInteractionViewName:{value:"photo-selector-sets-photolist-interaction-view"},itemFilterFunction:{value:function(t){return!t.getValue("isVideo")}},defaultSelected:{value:!1},selected:{},groupId:{},galleryId:{}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","flickr-api","html-file-dragdrop","hermes-template-photo-selector","photo-selector-photolist-view","photo-selector-limited-rows-photolist-view","photo-selector-photolist-interaction-view","photo-selector-sets-photolist-interaction-view","user-limits-helper"],optional:["search-photos-lite-models"],langBundles:["common","wallart","search","groups","profile","upload-blocking"]});YUI.add("hermes-lang-wallart",function(e,o){e.Intl.add("hermes/wallart","en-US",{WALL_ART:["Wall Art"],YOU_CANCELLED_THIS_ITEM_ON_DATE:["You cancelled this item order on ",{type:"date",valueName:"date",format:"monthYear"}],YOU_ORDERED_THIS_ITEM_ON_DATE:["You ordered this item on ",{type:"date",valueName:"date",format:"monthYear"}],RETURN_TO_YOUR_ORDER_HISTORY:["Return to your order history"],SELECT_A_PHOTO:["Select a photo"],SELECT_PRODUCT:["Select product"],PHOTO_MOUNT:["Photo Mount"],CANVAS:["Canvas"],CANVAS_WRAP:["Canvas Wrap"],PREMIUM_LUSTRE:["Premium Lustre"],GLOSSY:["Glossy"],MATTE:["Matte"],SIZE:["Size"],CHECKOUT:["Checkout"],REORDER:["Reorder"],TOTAL:["Total"],UPLOAD:["Upload"],CURATED_COLLECTIONS:["Curated Collections"],CREATIVE_COMMONS:["Creative Commons"],NASA:["NASA"],ABSTRACT:["Abstract"],ANIMALS:["Animals"],PATTERNS:["Patterns"],FOOD:["Food"],LANDSCAPES:["Landscapes"],TRAVEL:["Travel"],MY_ALBUMS:["My Albums"],PRODUCT_DROPUP_CANVAS:['Artist-grade canvas wrapped around 1.25" wood frame'],PRODUCT_DROPUP_MOUNTED:['Archival photo paper finished with 1" wood-textured edge'],MATERIAL_DROPUP_LUSTRE:["Professional Crystal Archive - Premium Lustre"],MATERIAL_DROPUP_GLOSSY:["Professional Crystal Archive - Glossy"],MATERIAL_DROPUP_MATTE:["Professional Crystal Archive - Matte"],SIZES_MODAL_SIZES_NOT_AVAILABLE:["Some sizes not available due to the resolution of the photo. Learn More."],MOUNTED_SAFE_AREA:["The area outside of the solid-line will not be printed. <br>Inside the line is the safe area."],CANVAS_SAFE_AREA:["The area outside of the dotted-line will be printed on the wrap. <br>Inside the line will be printed on the front."],SAVING:["Saving..."],SAVED:["All changes saved"],WITH_CODE:["with code:"],FREE_SHIPPING_WITH_CODE:["Free shipping with code:"],PRODUCT_DESCRIPTION_CANVAS_PART_1_8X10:['8" x 10" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_10X8:['10" x 8" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_12X12:['12" x 12" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_11X14:['11" x 14" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_14X11:['14" x 11" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_16X20:['16" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X16:['20" x 16" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X24:['20" x 24" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_24X20:['24" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X30:['20" x 30" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_30X20:['30" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_2:['1.25" stretcher bars<br>Impact resistant frame<br>Includes hardware to hang'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_8X10:['8" x 10" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_10X8:['10" x 8" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_12X12:['12" x 12" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_11X14:['11" x 14" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_14X11:['14" x 11" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_16X20:['16" x 20" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X16:['20" x 16" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X30:['20" x 30" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_30X20:['30" x 20" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE:['Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY:['Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE:['Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND:['Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND:['Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND:['Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PHOTO_TOO_SMALL_IN_SELECTED_SIZE:['This photo is too small to print in your selected size. We\'ll automatically find the next best size for you. <a href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567">Learn more.</a>'],BAD_SIZES:['Some sizes not available due to the resolution of the photo. <a target="_blank" href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567">Learn More</a>'],NOT_AVAILABLE:["Not available due to photo resolution"],UPLOADR_ERROR_MESSAGE_GENERIC:["There was a problem uploading your photo. Please try again."],UPLOADR_ERROR_MESSAGE_FILE_TYPE:["Looks like this photo has an invalid file type. Upload a photo that is either a PNG or JPG."],UPLOADR_ERROR_MESSAGE_FILE_SIZE:["Looks like this photo is too large to upload. The largest photo size we can upload is 250 MB."],UPLOADR_ERROR_MESSAGE_FILE_COUNT:["Select only one photo to upload."],UPLOADR_ERROR_MESSAGE_LOW_QUALITY:['Looks like this photo doesn\'t meet the minimum requirements to get printed. Please choose a photo that\'s at least 975 &times; 825 pixels. Learn more about <a href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567" target="_blank">requirements</a> for print products.'],UPLOADR_ERROR_MESSAGE_COLOR_SPACE:['Sorry, we cannot print photos with a CMYK or ProPhoto RGB colorspace. We recommend photos with an sRGB color space. <a href="https://help.yahoo.com/kb/flickr/creations-faq-sln22216.html?impressions=true#cont33" target="_blank">Learn more</a>.'],DRAG_DROP_TO_UPLOAD:['Drag and drop your photo to upload or <a href="#" class="simulate-file-select">browse</a>.'],PHOTOS_UPLOADED_AS_PRIVATE:['Photos uploaded here will be added to your <a href="/me/">Photostream</a> as private.'],LOW_QUALITY_ZOOM_HANDLE_TOOLTIP_CANVAS:["At this zoom level, your photo will print at a low quality. Please zoom out to purchase."],LOW_QUALITY_ZOOM_HANDLE_TOOLTIP_MOUNTED:["At this zoom level, your photo will print at a low quality. Please zoom out to purchase."],INITIAL_DIALOG_CANVAS_DISABLED:["Canvas Wrap is not available for this photo due to its low resolution. Canvas Wrap requires a minimum 975px x 825px."],INITIAL_DIALOG_MOUNTED_DISABLED:["Photo Mount is not available for this photo due to its low resolution. Photo Mount requires a minimum 1000px x 800px."],GO_BACK:["Go back"],PHOTO_NOT_LARGE_ENOUGH_TO_ROTATE:["This photo is not large enough to rotate into a different orientation."],CHANGE_SIZE:["Change size"],CHANGE_PHOTO:["Change photo"],CREATIONS:["Creations"],VIEW_ORDER_HISTORY:["View order history"],COMPLETED:["Completed"],IN_PROGRESS:["In progress"],CREATE_NEW:["Create new"],CREATIONS_EMPTY_WALLART:["No Wall Art to show"],CREATIONS_EMPTY_BOOKS:["No Photo Books to show"],CREATIONS_EMPTY_TERTIARY:['We\'ll display in progress and completed creations here.<br>Learn more about <a href="/create" title="">Wall Art</a> and <a href="/create" title="">Photo Books</a>.'],CREATIONS_NOT_ABLE_DELETE:["We were not able to delete this creation. Please try again later."],PHOTO_FOR_WALLART_DELETED:["The photo for this wall art was deleted"],DELETE_THIS_WALLART:["Delete this wall art"],REORDER_THIS_WALLART:["Reorder this wall art"],EDIT_THIS_WALLART:["Edit this wall art"],CHANGE_PAPER:["Change paper"],MATERIAL_DROPUP_LUSTRE_NEW:['Lustre\'s pearl-like finish gives your photo a "true-to-life" look. It provides the color saturation of glossy but the fingerprint resistance of matte.'],MATERIAL_DROPUP_GLOSSY_NEW:["A sleek, glossy finish with high-contrast appearance so your photos appear crisp and sharp. Great for highly reflective photos of water, metal or sky."],MATERIAL_DROPUP_MATTE_NEW:["An elegant, matte finish with lower contrast to enhance the texture of your photo. Resists fingerprints and is great for black and white photos."],ON_SALE:["On Sale"],PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW:['<span>1.25" stretcher bars</span><span>Impact resistant frame</span><span>Includes hardware to hang</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_PREVIEW:['<span>Matte finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_PREVIEW:['<span>Glossy finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_PREVIEW:['<span>Premium lustre finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND_PREVIEW:['<span>Matte finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND_PREVIEW:['<span>Glossy finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND_PREVIEW:['<span>Premium lustre finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PHOTO_BOOK:["Photo Book"],GLOSSY_HARDCOVER_BOOK_PREMIUM_LUSTRE_PAPER:['11" x 8.5" glossy hardcover book with premium lustre paper'],LOW_QUALITY_WARNING:["This photo cannot be printed because the resolution is too low."],INVALID_COLORSPACE_WARNING:["This photo cannot be printed because it uses a colorspace that is not supported."],LOW_QUALITY_TYPE_WARNING:["This photo cannot be printed with this type of wallart because the resolution is too low."],NO_COMPLETED_ORDER:["No completed orders."]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-profile",function(e,o){e.Intl.add("hermes/profile","en-US",{MEMBER_DESCRIPTION:["Description"],MEMBER_INFO:["Member info"],EMPTY_DESCRIPTION:["Write a little about yourself"],ABOUT_USERNAME:["About ","${username}"],MOST_POPULAR_PHOTOS:["Most popular photos"],MOST_POPULAR_PHOTOS_EMPTY_TITLE:["Your most popular photos will appear here."],MOST_POPULAR_PHOTOS_EMPTY_TEXT:["Set your photos to public for more faves, comments and views."],MOST_POPULAR_PHOTOS_EMPTY_TEXT_2:["For even more exposure, add them to Groups"],HAS_NO_PUBLIC_PHOTOS_YET:["${username}"," hasn't made any photos public yet."],MOST_POPULAR_PHOTOS_GO_TO_CR:["Go to Camera Roll"],TESTIMONIALS:["Testimonials"],PHOTOS_OF:["Photos of ","${username}"],READ_MORE:["Read more"],READ_LESS:["Read less"],EDIT_DESCRIPTION:["Edit description"],EDIT_INFOS:["Edit your profile information"],EDIT_SHOWCASE:["Edit your showcase"],CHANGE_SHOWCASE_PHOTOS:["Change your showcase photos"],SHOWCASE_FULL:["Your showcase is full! Change photos"],SHOWCASE_ALMOST_FULL:["One photo to go, choose well!"],ADD_PHOTOS:["Add photos"],VIEW_ALL:["View all"],THIS_YOUR_SHOWCASE:["This is your showcase."],SHOW_OFF_YOUR_PHOTOS:["Show off up to ","${limit}"," of your photos."],GET_STARTED:["Get started"],CHOOSE_UP_TO_PHOTOS:[{type:"plural",valueName:"limit",options:{one:"Choose up to ${#} more photo",other:"Choose up to ${#} more photos"}}],SELECT_PHOTOS:["Select photos"],SHOWCASE_ALREADY_THERE:["This photo is already in your showcase."],SHOWCASE_ERR:["An error has occurred. Please refresh the page."],BIO_JOINED:["Joined"],BIO_OCCUPATION:["Occupation"],BIO_HOMETOWN:["Hometown"],BIO_CURRENT_CITY:["Current city"],BIO_COUNTRY:["Country"],BIO_WEBSITE:["Website"],BIO_EMAIL:["Email"],BIO_FACEBOOK:["Facebook"],BIO_TWITTER:["Twitter"],BIO_INSTAGRAM:["Instagram"],BIO_PINTEREST:["Pinterest"],BIO_TUMBLR:["Tumblr"],BIO_RELATIONSHIP:["Relationship"],COUNTS_GROUPS:[{type:"plural",valueName:"groupsCount",options:{one:"group",other:"groups"}}],COUNTS_GEOTAGGED:[{type:"plural",valueName:"geoCount",options:{one:"geotagged photo",other:"geotagged photos"}}],COUNTS_GEOTAGS:[{type:"plural",valueName:"geoCount",options:{one:"geotag",other:"geotags"}}],COUNTS_FAVORITES:[{type:"plural",valueName:"favesCount",options:{one:"fave",other:"faves"}}],COUNTS_TAGS:[{type:"plural",valueName:"tagsCount",options:{one:"tag",other:"tags"}}],COUNT_VIEWS:[{type:"plural",valueName:"viewsCount",options:{one:"view",other:"views"}}],BLOCK_USER:["Block user"],FILTER_FAVES:["Most faved"],FILTER_VIEWS:["Most viewed"],FILTER_COMMENTS:["Most commented"],FILTER_INTERESTING:["Most interesting"],AWESOME:["Awesome!"],REFRESH_NOW:["Refresh now to see your showcase."],TOO_MANY_PHOTOS:["Sorry, you can't add more than ","${limit}"," photos to your showcase."],PROFILE_SHARE_FEEDBACK:['This new Flickr Profile is only visible to Alpha Group members. Please share your feedback <a href="',"${url}",'">here</a>.'],PROFILE_SHARE_FEEDBACK_ONBOARDING:['Profiles got a makeover. We really want to know what you think. <a href="',"${url}",'">Send us some feedback!</a>'],PROFILE_CHECK_OUT:['Profiles got a makeover — check out your <a href="',"${urlAbout}",'">new About page</a>! Then, <a href="',"${urlFeedback}",'" target="_blank">let us know what you think</a>!'],PROFILE_PHOTO_NOT_PUBLIC:["This photo does not seem to be public."],PROFILE_SAVED_MAGICALLY:["Changes are saved automagically!"],PROFILE_SAVED_AUTO:["Changes are saved automatically!"],SAVING:["Saving"],PLACEHOLDER_SOCIAL:["Your username or profile link"],EVERYONE:["Everyone"],ANY_FLICKR_MEMBER:["Any Flickr Member"],PEOPLE_I_FOLLOW:["People I follow"],FRIENDS_AND_FAMILY:["Friends and family"],ONLY_ME:["Only me"],USER_FOLLOWS_YOU:["${username}"," is following you."],USER_IS_FAMILY:["${username}"," counts you as Family."],USER_IS_FRIEND:["${username}"," counts you as a Friend."],USER_IS_FRIEND_FAMILY:["${username}"," counts you as Friend & Family."],TESTIM_PENDING:["Pending"],TESTIM_EMPTY_SELF:["Nobody has added a testimonial for you yet."],TESTIM_EMPTY_SOMEONE:["Nobody has added a testimonial yet."],TESTIM_EMPTY:["Have something nice to say about ","${username}","?"],TESTIM_WRITE:["Write a testimonial"],TESTIM_POST:["Post"],TESTIM_SHOW_MORE:["View more"],TESTIM_APPROVE:["Approve"],TESTIM_REJECT:["Reject"],TESTIM_SENT_APPROVAL:["Your testimonial will be sent to ","${username}"," for approval."],TESTIM_SENT_APPROVAL_SHOWN:["Your testimonial will be shown once ","${username}"," approves it."],TESTIM_GREAT_TITLE:["Great!"],TESTIM_DELETE_CONFIRM:["Delete this post?"],TESTIM_DELETE_TEXT:["You cannot reverse this action. Are you sure you want to permanently delete this post?"],TESTIM_EDIT_CONFIRM_TITLE:["Edit this post?"],TESTIM_EDIT_CONFIRM_TEXT:["If you choose to edit this post, it will be sent back to the person you're writing about for approval."],TESTIM_EDIT_VISIT_PROFILE:["You can edit this testimonial on ","${username}","'s profile."],TESTIM_EDIT_VISIT_PROFILE_TEXT:["If you choose to edit this post, it will be sent back to ","${username}"," for their approval."],TESTIM_EDIT_VISIT_PROFILE_GO:["Go to profile"],YOUR_SELECTION_HEADER:["Your Selection"],NO_PHOTOS_SELECTED:["No photos selected."],SELECTED:["Selected"],PROFILE_SHOWCASE_TITLE:["Profile showcase"],PROFILE_SHOWCASE_TITLE_SHORT:["Showcase"],PROFILE_WHATS_NEW:["What’s new?"],PROFILE_BIO_TOOLTIP:["Add a few more details about yourself to complete your profile."],PROFILE_POPULAR_TOOLTIP:["These are your most popular photos on Flickr. You can choose to have this section visible to everyone or only to you."],PROFILE_PHOTOSOF_TOOLTIP:["You can tag and untag yourself in photos by visiting the “People in photo” section on the photo page."],PROFILE_PHOTOSOF_MODAL_TITLE:["Untag yourself from this photo ?"],PROFILE_CHECK_IT_OUT:["Check it out"],PROFILE_GOT_IT:["Got it, thanks"],TESTIM_FILTER_RECEIVED:["Received"],TESTIM_FILTER_GIVEN:["Given"],TESTIM_NOTHING_TO_SHOW:["Nothing to show."],TESTIM_POSTED_ON:[{type:"date",valueName:"intlDate",format:"long"}],TESTIM_AUTHOR_SAYS:['<a href="',"${url}",'" class="username">',"${displayname}","</a> says:"],TESTIM_AUTHOR_FOR:['For <a href="',"${url}",'" class="username">',"${displayname}","</a>:"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-fluid-modal-nav-bar",function(a,e){var n=a.Template.Handlebars.revive({1:function(a,e,n,l,t){var r;return null!=(r=n.unless.call(null!=e?e:{},null!=e?e.disabled:e,{name:"unless",hash:{},fn:a.program(2,t,0),inverse:a.noop,data:t}))?r:""},2:function(a,e,n,l,t){var r,u,i=null!=e?e:{},s=n.helperMissing,o=a.escapeExpression;return'\t\t\t<li data-id="'+o("function"==typeof(u=null!=(u=n.id||(null!=e?e.id:e))?u:s)?u.call(i,{name:"id",hash:{},data:t}):u)+'" data-value="'+o("function"==typeof(u=null!=(u=n.value||(null!=e?e.value:e))?u:s)?u.call(i,{name:"value",hash:{},data:t}):u)+'" class="link '+(null!=(r=n.if.call(i,null!=e?e.selected:e,{name:"if",hash:{},fn:a.program(3,t,0),inverse:a.noop,data:t}))?r:"")+" "+(null!=(r=n.if.call(i,null!=e?e.hiddenByDefault:e,{name:"if",hash:{},fn:a.program(5,t,0),inverse:a.noop,data:t}))?r:"")+'" tabindex="0"><a data-value="'+o("function"==typeof(u=null!=(u=n.value||(null!=e?e.value:e))?u:s)?u.call(i,{name:"value",hash:{},data:t}):u)+'">'+o("function"==typeof(u=null!=(u=n.name||(null!=e?e.name:e))?u:s)?u.call(i,{name:"name",hash:{},data:t}):u)+"</a></li>\n"},3:function(a,e,n,l,t){return"selected"},5:function(a,e,n,l,t){return"hidden"},7:function(a,e,n,l,t){return'\t\t\t<form action="/search" method="get" role="search">\n\t\t\t\t<input type="text" name="text" value="" class="search-field" autocomplete="off" aria-label="Search" role="textbox">\n\t\t\t\t<input type="submit" class="search-icon" tabindex="-1" aria-label="Search" role="button">\n\t\t\t</form>\n'},compiler:[7,">= 4.0.0"],main:function(a,e,n,l,t){var r,u=null!=e?e:{};return'<div class="fluid-modal-nav-bar">\n\t<div class="fluid-modal-nav-content">\n\t\t<ul class="links">\n'+(null!=(r=n.each.call(u,null!=e?e.links:e,{name:"each",hash:{},fn:a.program(1,t,0),inverse:a.noop,data:t}))?r:"")+"\t\t</ul>\n"+(null!=(r=n.if.call(u,null!=e?e.enableSearch:e,{name:"if",hash:{},fn:a.program(7,t,0),inverse:a.noop,data:t}))?r:"")+"\t</div>\n</div>\n"},useData:!0}),l={};a.Array.each([],function(e){var n=a.Template.get("hermes/"+e);n&&(l[e]=n)}),a.Template.register("hermes/fluid-modal-nav-bar",function(e,t){return t=t||{},t.partials=t.partials?a.merge(l,t.partials):l,n(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("fluid-modal-nav-bar-view",function(e){"use strict";var t;t={css:{nav:".fluid-modal-nav-bar",navContent:".fluid-modal-nav-content",links:".links",link:".link"},options:{}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t,i,n=this.get("breakpointConfig")||[],a=this.appContext.viewportData.getWidth();for(i=n.sort(function(e,t){return e.maxWidth-t.maxWidth}),t=0;t<i.length;t++)if(a<i[t].maxWidth){this.mobileConfig=i[t],this.set("links",this.mobileConfig.links),this.set("enableSearch",this.mobileConfig.enableSearch);break}return this},loadState:function(){return this},buildContainer:function(){var e;return e={links:this.get("links"),enableSearch:this.get("enableSearch")},this.setContainerWithTemplate("fluid-modal-nav-bar",e),this},activate:function(){var e=this.get("container"),t=this;return this.registerEventHandler(e.on("click",this.handleClick.bind(this))),this.registerEventHandler(e.on("key",this.handleClick.bind(this),"down:13")),this.get("links").forEach(function(i){i.selected&&t.set("currentSelection",e.one('.link[data-id="'+i.id+'"]'))}),this},deselectAll:function(){this.get("container").one(t.css.nav).one(t.css.navContent).one(t.css.links).all(t.css.link).removeClass("selected")},handleClick:function(t){var i,n,a=t.target,s=a.get("parentNode"),l=this.get("container"),r={},o=this.appContext.getViewer().nsid;"a"===a.getDOMNode().tagName.toLowerCase()?(t.halt(),this.deselectAll(),s.addClass("selected"),this.set("currentSelection",s),(i=l.one(".search-field"))&&(i.getDOMNode().value=""),this.fire("subviewViewEvent","navigation",t)):a.hasClass("link")?(t.halt(),this.deselectAll(),a.addClass("selected"),this.set("currentSelection",a),(i=l.one(".search-field"))&&(i.getDOMNode().value=""),this.fire("subviewViewEvent","navigation",t)):(i=l.one(".search-field"),this.get("enableSearch")&&i&&(n=l.one(".search-field").getDOMNode(),"submit"===a.getDOMNode().type&&(t.halt(),r.apiParams={},r.apiParams[e.AttributeHelpers.coerceString(n.name)]=n.value,r.id=e.SearchHelper.generateQueryString(r.apiParams)||e.guid(),r.viewerNsid=o,this.fire("subviewViewEvent","search",r),this.deselectAll(),this.set("currentSelection",{type:"search",modelParams:r}))))},onParentViewEvent:function(t,i){var n=this.get("currentSelection");"backToList"===i[0]&&(n instanceof e.Node?this.get("currentSelection").getDOMNode().click():"search"===n.type&&this.fire("subviewViewEvent","search",n.modelParams))}},{ATTRS:{links:{value:[],validator:function(t){return e.Lang.isArray(t)}},currentSelection:{value:null},enableSearch:{value:!0,validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},breakpointConfig:{value:null}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-modal-nav-bar","attribute-helpers","search-helper"],langBundles:["common","wallart"],optional:["person-models","photo-models"]});YUI.add("banner-view",function(i,e){require("hermes-core/flog")(e);i.FlickrView.create(this.name,i.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){this.params=i,this.subview=this.params.subview},loadState:function(){return i.Promise.resolve()},buildContainer:function(){},activate:function(){var i=this,e=this.get("container");return this.subviewParent=e,this.subview?(this.subview.on("dismiss",function(e){i.dismiss()}),this.subview.initialize().then(function(){return i.setupSubview()})):this},setupSubview:function(){var i=this,e=i.subview.get("container");return i.subviewParent.empty(),i.subviewParent.appendChild(e),i.subview.on("activated",function(){i.fire("subviewActivated")}),i.subview.activate()},dismiss:function(){this.get("container").remove(),this.fire("dismissed"),this.destroy()}})},"@VERSION@",{requires:["flickr-view"],langBundles:["common"]});YUI.add("math-helper",function(e){e.MathHelper=function(e){return{seedRandom:function(e){return 0+1*((e=(9301*e+49297)%233280)/233280)}}}},"@VERSION@",{requires:[]});YUI.add("banner-helper",function(e,n){require("hermes-core/flog")(n),e.mix({langBundles:["featured-banner"]},e.Localizable);e.BannerHelper=function(n){function i(){t=r.sort(function(e,n){return e.priority-n.priority})}var r=[],t=[];return{registerBanner:function(e){r.push(e),i()},grabFirstBanner:function(){var e,n=t.find(function(n,i){if(n.canShowBanner())return e=i,!0});if(n)return(function(e){r.splice(e,1),i()})(e),n},getQueue:function(){return t},typeObjects:{loginMigration:function(i){return{priority:"priority"in i?i.priority:Number.MAX_VALUE,load:function(){return e.Promise.resolve()},canShowBanner:function(){var e=!1,i=n.getViewer().isCognitoUser;return!n.getViewer().signedIn||i||(function(){var e=n.flapp.get("activeView").name;return!!(e&&["products-pro-2018-view"].indexOf(e)>-1)})()||(e=!0),e},viewName:"login-migration-banner-view",viewConfig:{}}},pastDue:function(i){var r;return{priority:"priority"in i?i.priority:Number.MAX_VALUE,load:function(){return n.getViewer().signedIn?n.getModel("subscription-history-list-models",n.getViewer().nsid).then(function(n){var i=new e.SubscriptionsHelper;r=i.isUserPastDue(n)}.bind(this)):(r=!1,e.Promise.resolve())},canShowBanner:function(){var i=!1;return n.getViewer().signedIn&&r&&!n.getCookie(e.config.flickr.banners.dismiss_past_due_banner_name)&&!(function(){var e=n.flapp.get("activeView").name;return!!(e&&["products-pro-2018-view","account-settings-view"].indexOf(e)>-1)})()&&(i=!0),i},viewName:"past-due-banner-view",viewConfig:{}}},blackFriday:function(i){var r;return{priority:"priority"in i?i.priority:Number.MAX_VALUE,load:function(){return n.getViewer().signedIn?n.getModel("subscription-history-list-models",n.getViewer().nsid).then(function(n){var i=new e.SubscriptionsHelper;r=i.isUserPastDue(n)}.bind(this)):(r=!1,e.Promise.resolve())},canShowBanner:function(){var i=!1;return!n.flipper.isFlipped("enable-black-friday-banner-campaign")||"en-us"!==n.lang.toLowerCase()||n.getViewer().isPro||n.getCookie(e.config.flickr.banners.dismiss_black_friday_banner_name)||(function(){var e=n.flapp.get("activeView").name;return!!(e&&["products-pro-2018-view"].indexOf(e)>-1)})()||(i=!0),i},viewName:"black-friday-banner-view",viewConfig:{}}},cookie:function(i){return{priority:"priority"in i?i.priority:Number.MAX_VALUE,load:function(){return e.Promise.resolve()},canShowBanner:function(){return!n.getCookie(e.config.flickr.banners.dismiss_cookie_banner_name)&&e.config.flickr.geo.eu},viewName:"cookie-banner-view",viewConfig:{}}}},initBannerView:function(e){return n.getView(e.viewName,{appContext:n}).then(function(e){var i;return n.getView("banner-view",{appContext:n,subview:e}).then(function(e){return(i=e).initialize()}).then(function(){return i})})}}}},"@VERSION@",{requires:["banner-view"]});YUI.add("global-nav-view",function(e,t){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i,n;if(void 0===t.enableBrowserUpgradeBanner&&(t.enableBrowserUpgradeBanner=!0),this.set("showBrowserUpgradeBanner",!1),YUI.Env.isServer&&t.enableBrowserUpgradeBanner){var o=this.appContext.request.headers["user-agent"],s=e.BrowserSupport.isUnsupportedBrowser(o),a=e.BrowserSupport.isBot(o),r=e.BrowserSupport.isSharingBot(o);!s||a||r||this.set("showBrowserUpgradeBanner",!0)}if(!YUI.Env.isServer){var l=e.StorageHelper.getItem("hasDismissedBrowserUpgradeBanner",!0);l&&"true"===l&&this.set("showBrowserUpgradeBanner",!1)}return""===this.get("container").get("innerHTML")&&this.setContainerHTML('<div class="global-nav-content"></div>'),this.appStateParams=t,this.themeClass=t.theme||"default-theme",i=this.appContext.getLocation(),n=t.modelParams&&t.modelParams.apiParams?t.modelParams.apiParams:i.href,this.searchUrl=new e.SearchUrl(n,this.appContext,t.searchType),this.appContext.flipper.isFlipped("enable-signed-out-cta-test")&&(this.signedOutTest=!0),this.appContext.flipper.isFlipped("enable-sign-up-interstitial-test")&&"en-us"===this.appContext.lang.toLowerCase()&&(this.signUpInterstitialTest=!0),!this.appContext.flipper.isFlipped("enable-sign-up-rail-test")||"en-us"!==this.appContext.lang.toLowerCase()||this.appContext.getViewer().signedIn||t.isSOHP||(this.signUpRailTest=!0),this.isSOHP=t.isSOHP,this.disableMobileNav=t.disableMobileNav,this.hideBanner=t.isSearchResults,this.isRefencingAnnouncementPage=t.isRefencingAnnouncementPage,t.featuredToastConfig={id:"upload-limit-warning-toast",showOnActivate:!1},this.uploadLimitDismissHours=48,this.photoPrintsHelper=new e.PhotoPrintsHelper(this.appContext),this.mathHelper=new e.MathHelper,this.bannerHelper=new e.BannerHelper(this.appContext),this},subviewConfig:{"search-autosuggest-field-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,isSOHP:this.isSOHP},"account-menu-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"notifications-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("notifications-menu")}},"browser-upgrade-banner-view":{requiredToShowOnServer:!0,requiredToShowOnClient:!1,dealbreaker:!1,disabled:function(){return!this.get("showBrowserUpgradeBanner")}},"person-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!(this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list"))}},"group-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!(this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list"))}},"signup-rail-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["collapsed"],disabled:function(e){return e.isMobile||!this.signUpRailTest}},"flickr-chat-center-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(e){return!this.appContext.flipper.isFlipped("flickr-chat")||!this.appContext.getViewer().signedIn}},"partner-account-banner-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1},"featured-toast-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var t=this,i=this.appContext.getViewer(),n=[];return i.signedIn?(n.push(this.appContext.getModel("person-models",i.nsid).then(function(e){t.set("viewer",e),t.elementStates=t.setElementStates(t.appStateParams)})),n.push(this.appContext.getModel("person-profile-models",i.nsid).then(function(e){t.profileModel=e}))):this.elementStates=this.setElementStates(this.appStateParams),e.Promise.all(n).then(function(){t.get("viewer")&&!YUI.Env.isServer&&t.appContext.flipper.isFlipped("enable-feedback-modal")&&t.appContext.getViewer().signedIn&&"en-US"===t.appContext.lang&&e.config.flickr&&e.config.flickr.geo&&"US"===e.config.flickr.geo.countryCode&&!localStorage.getItem("feedbackmodalseen8_19")&&"photostream-route"!==this.appContext.routeConfig.module&&(t.meetsFeedbackCriteria=!0)})},buildContainer:function(){var t,i={},n=this.appContext.getViewer().signedIn;return this.get("viewer")&&(i=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),t={theme:this.themeClass,disableMobileNav:this.disableMobileNav,"show-browser-upgrade-banner":this.get("showBrowserUpgradeBanner"),showNotificationsMenu:!1,viewer:i,isSignedIn:n,elements:this.elementStates,isRefencingAnnouncementPage:this.isRefencingAnnouncementPage,showFeaturedToast:(this.appContext.flipper.isFlipped("enable-upload-limit-warning")||this.appContext.flipper.isFlipped("enable-upload-limit-messages"))&&this.appContext.getViewer().signedIn},this.appContext.flipper.isFlipped("notifications-menu")&&n&&(t["notifications-menu-view"]=this.subviews["notifications-menu-view"].get("container"),t.showNotificationsMenu=!0),this.photoPrintsHelper.isPrintsEnabled()&&(t.printCartUrl=this.photoPrintsHelper.getCartUrl(),t.showPrintsNewLabel=this.photoPrintsHelper.shouldShowNewBadge()),this.setContainerWithTemplate("global-nav",t),this},activate:function(){var i,n,o,s,a,r,l=this,p=this.get("container");n=["photo-page-ad-scrappy-view","sohp-view"],i=this.appContext.flapp.get("activeView").name,this.contentContainer=p.one(".global-nav"),p.one(".mobile-nav-toggle")&&(this.navDrawer=p.one(".mobile-nav-drawer"),this.navDrawerOverlay=p.one(".mobile-nav-drawer-overlay"),this.registerEventHandler(p.one(".mobile-nav-toggle").on("click",function(e){l.navDrawerShown?l.hideMobileNavDrawer():l.showMobileNavDrawer()})),this.registerEventHandler(this.navDrawer.delegate("click",this.handleDrawerItemClick.bind(this),".mobile-nav-menu-item"))),p.one(".mobile-search-button")?(this.registerEventHandler(p.one(".mobile-search-button").on("click",function(t){e.rapidTracker.beacon(l.name,"mobile-nav-search");var i=l.get("container");l.contentContainer.addClass("search-open"),l.fire("parentViewEvent","focus-search-field"),i.one(".flickr-logo-container").addClass("hidden")}.bind(this))),this.registerEventHandler(e.on("add-context-to-search-field",function(e){l.contentContainer.addClass("search-open"),l.fire("parentViewEvent","focus-search-field")},this))):this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(t){var i=e.config.win.innerWidth<=700,n=i?this.appContext.viewportData.getWidth():0,o=i?46:0;i||(l.contentContainer.removeClass("search-open"),p.one(".flickr-logo-container").removeClass("hidden")),l.fire("parentViewEvent","resize-search-field",n-o)}.bind(this))),p.one(".mobile-search-close-button")&&this.registerEventHandler(p.one(".mobile-search-close-button").on("click",function(e){l.contentContainer.removeClass("search-open"),p.one(".flickr-logo-container").removeClass("hidden"),l.fire("parentViewEvent","clear-search-field")}.bind(this))),this.appContext.getViewer().signedIn||(this.signedOutTest&&p.one(".gn-upload .gn-title")&&this.registerEventHandler(p.one(".gn-upload .gn-title").on("click",this.signUpAndUpload.bind(this))),n.indexOf(i)<0&&!this.isMobile&&this.signUpInterstitialTest&&this.startInterstitialTimer()),e.AnchorRepositioner.addOffset(t,p),this.registerEventHandler(p.delegate("keydown",this.toggleSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(p.delegate("keydown",this.enterSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(p.on("keydown",this.goToSubmenuHeading.bind(this),"ul.gn-submenu")),this.registerEventHandler(p.delegate("keydown",this.keyboardNavigation.bind(this),"ul.nav-menu")),this.registerEventHandler(p.delegate("mouseup",this.toggleAriaExpanded.bind(this),"a[aria-haspopup=true]")),this.showFeedbackModal(),this.toastSubview=this.subviews["featured-toast-view"],this.toastSubview.isActivated?l.setupToast():this.toastSubview.on("activated",function(){l.setupToast()}),e.on("accountCard:overLimitLearnMoreClick",function(){l.setupToast(!0)}),e.on("printsPage:choosePhotosClicked",function(){l.handlePrintClick()}),this.photoPrintsHelper.isPrintsEnabled()&&(this.printsButton=p.one(".gn-create .prints-button"),this.mobilePrintsButton=p.one(".mobile-nav-drawer .prints-button"),this.cartLink=p.one(".gn-create .cart-link"),this.mobileCartLink=p.one(".mobile-nav-drawer .cart-link"),this.registerEventHandler(this.printsButton.on("click",this.handlePrintClick.bind(this))),this.registerEventHandler(this.mobilePrintsButton.on("click",this.handlePrintClick.bind(this))),this.photoPrintsHelper.fetchCartCount().then(function(e){var t=e?e.count:0,i=l.intlMessage({intlName:"prints.VIEW_CART_WITH_COUNT",count:void 0!==t?t.toString():"0"});t>0&&(l.cartLink.removeClass("disabled"),l.mobileCartLink.removeClass("disabled")),l.cartLink.set("innerHTML",i),l.mobileCartLink.set("innerHTML",i)}).catch(function(e){var t=l.intlMessage({intlName:"prints.VIEW_CART_WITH_COUNT",count:"0"});l.cartLink.set("innerHTML",t),l.mobileCartLink.set("innerHTML",t)}),this.prepareOrderConfirmationModal()),o=this.appContext.getViewer(),s=new this.bannerHelper.typeObjects.loginMigration({priority:2}),a=new this.bannerHelper.typeObjects.pastDue({priority:3}),r=new this.bannerHelper.typeObjects.blackFriday({priority:0});var c=[s.load().then(function(e){l.bannerHelper.registerBanner(s)}),a.load().then(function(e){l.bannerHelper.registerBanner(a)}),r.load().then(function(e){l.bannerHelper.registerBanner(r)})];return e.Promise.all(c).then(function(){var e=l.bannerHelper.grabFirstBanner();if(e)return l.bannerHelper.initBannerView(e)}).then(function(t){var i=t.get("container"),n=p.one(".nav-banner-container");return n.empty(),n.appendChild(i),t.on("subviewActivated",function(){e.fire("globalNav:bannerSubviewActivated")}),t.on("dismissed",function(){t.get("container").remove(),t.destroy(),e.fire("globalNav:bannerDismissed")}),t.normalizedActivate()}),this.appContext.flipper.isFlipped("enable-photo-limit-pro-redir")&&o.signedIn&&"en-us"===this.appContext.lang.toLowerCase()&&e.UserLimitsHelper.isOverARRLimit(this.profileModel,this.appContext)&&!this.appContext.getCookie(e.config.flickr.upload_blocking.photo_limit_pro_redir_cookie_name)&&(this.setProRedirectCookie(),this.appContext.flapp.navigate(e.config.flickr.upload_blocking.photo_limit_pro_redir_url)),this},showFeedbackModal:function(){var t=this,i=e.QueryString.parse(e.config.win.location.search.replace("?","")),n=e.config.win.location.href;if(t.appContext.flipper.isFlipped("enable-feedback-modal")&&i&&void 0!==i.survey&&(n=n.replace("?survey",""),e.config.win.history.replaceState({},"",n),this.meetsFeedbackCriteria=!0),this.meetsFeedbackCriteria){var o,s=this.templates("feedback-modal-view")({}),a=[],r=!0;return this.appContext.getViewer().signedIn&&(this.get("viewer").getValue("isPro")&&a.push(this.appContext.getModel("person-proStatus-models",t.get("viewer").id).then(function(e){t.proStatusModel=e,r=1e3*e.toJSON().firstStart-new Date("November 1, 2018").getTime()>0})),a.push(this.appContext.getModel("person-profile-models",t.get("viewer").id).then(function(e){t.profileModel=e}))),e.Promise.all(a).then(function(){var i;t.get("viewer").getValue("isPro")&&!r||((i=new e.Views.FluidModal({appContext:t.appContext,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showFooter:!1,classList:"modal-restyle",width:560,htmlMessage:s})).show(),i.on("activated",function(){o=i.get("container").one(".accept-button"),i.get("container").one(".cancel-button").on("click",function(e){i.close()}),o.on("click",function(e){var n,s,a,r,l="https://selfserve.decipherinc.com/survey/selfserve/2225/170601?list=3",p="no";o.setAttribute("disabled"),t.appContext.getViewer().signedIn&&(s=t.appContext.getViewer().nsid,n=t.get("viewer").getValue("isPro")?"pro":"free",r=t.get("viewer").getValue("dateCreated").year()),t.proStatusModel&&(p=1e3*t.proStatusModel.toJSON().firstStart-new Date("November 1, 2018").getTime()>0?"yes":"no"),t.profileModel&&(a=t.profileModel.getValue("photoCount")),a&&(l+="&nop="+encodeURIComponent(a)),n&&(l+="&at="+encodeURIComponent(n)),p&&(l+="&np="+encodeURIComponent(p)),r&&(l+="&y="+encodeURIComponent(r)),s&&(l+="&id="+encodeURIComponent(s)),window.open(l,"_blank"),i.close()})}),i.on("close",function(){localStorage.setItem("feedbackmodalseen8_19",!0)}))})}},clearKeyboardFocus:function(e){this.get("container").all(".has-keyboard-focus").removeClass("has-keyboard-focus"),this.get("container").all(".nav-menu a[aria-expanded=true]").setAttribute("aria-expanded","false")},toggleAriaExpanded:function(e){e.target.setAttribute("aria-expanded","false"===e.target.getAttribute("aria-expanded")?"true":"false")},enterSubmenu:function(e){if(40===e.keyCode){e.preventDefault();var t=e.target.next("ul");t&&t.hasClass("has-keyboard-focus")&&t.one(":first-child").one(":first-child").focus()}},toggleSubmenu:function(e){var t=e.keyCode;if(13===t||32===t){e.preventDefault();var i=e.target.next("ul");i&&(i.hasClass("has-keyboard-focus")?this.clearKeyboardFocus():(i.addClass("has-keyboard-focus"),e.target.setAttribute("aria-expanded","true")))}},goToSubmenuHeading:function(e,t){var i;(t||27===e.keyCode)&&(t||this.clearKeyboardFocus(),e.target.hasClass("gn-submenu")?i=e.target.previous("a"):e.target.ancestor("ul.gn-submenu")&&(i=e.target.ancestor("ul.gn-submenu").previous("a")),i&&i.focus())},keyboardNavigation:function(e){var t=e.keyCode,i=9===t&&e.shiftKey,n=9===t&&!e.shiftKey;e.target.hasClass("gn-title")?(i=(37===t||i)&&e.target.ancestor("li").previous("li"),n=(39===t||n)&&!!e.target.ancestor("li").next("li"),i?(this.clearKeyboardFocus(),this.focusOnPreviousItem(e)):!n||e.target.next("ul")&&e.target.next("ul").hasClass("has-keyboard-focus")||(this.clearKeyboardFocus(),this.focusOnNextItem(e))):38===t||i?this.focusOnPreviousItem(e):(40===t||n)&&this.focusOnNextItem(e)},focusOnPreviousItem:function(e){e.preventDefault();var t=e.target.ancestor("li").previous("li:not(.divider)");t?t.one(":first-child").focus():e.target.ancestor("ul.gn-submenu")&&this.goToSubmenuHeading(e,!0)},focusOnNextItem:function(e){e.preventDefault();var t=e.target.ancestor("li").next("li:not(.divider)");t&&t.one(":first-child").focus()},startInterstitialTimer:function(){var t,i=this,n=!1;(t=e.StorageHelper.getItem("signUpInterstitialSeen"))?(t=e.moment(t,"x"),e.moment().subtract(2,"days")>t&&(n=!0)):n=!0,n&&(this.signUpInterstitialTimer=setTimeout(function(){if(!e.OverlayManager.hasOverlay()&&e.config.win.innerWidth>700){new e.Views.SignUpInterstitial({appContext:i.appContext}).show(),e.StorageHelper.setItem("signUpInterstitialSeen",e.moment().format("x"))}},4e3))},signUpAndUpload:function(t){var i,n=e.url("/upload/"),o=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_TITLE"}),s=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_MESSAGE"});t.halt(),e.rapidTracker.beacon(this.name,"uploadButtonClick"),(i=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-upload",signUpTitle:o,signUpMessage:s,beaconPrefix:"upload"})).on("signUpClick",function(t){e.SigninHelper._redirectToSignUp("upload",{postLoginUrl:n})}),i.on("signInClick",function(t){e.SigninHelper._redirectToSignin("upload",{postLoginUrl:n})}),i.show()},executeSearch:function(e){var t,i=this.get("container").one("#gn-search-field").getDOMNode();t=this.searchUrl.createNewSearch(i.value).getURL(),e.halt(),this.appContext.flapp.navigate(t)},setElementStates:function(e){var t=this.appContext.getViewer(),i={you_link:!1,you_menu:!1,contacts_menu:!1,groups_menu:!1,explore_menu:!1,weekly_flickr:!1,create_link:!0,get_pro_link:!0,upload_icon:!1,account_menu:!1,search_bar:!1,signup_link:!1,signin_link:!1,right_side_signup:!1,vr_link:!0};return e.isSOHP&&!t.signedIn?(i.search_bar=!0,i.signin_link=!0,i.signup_link=!0,i.create_link=!1,i.get_pro_link=!1):t.signedIn?(i.you_menu=!0,i.explore_menu=!0,i.upload_icon=!0,i.search_bar=!0,i.account_menu=!0):(i.signup_link=!0,i.explore_menu=!0,i.upload_icon=!0,i.search_bar=!0,i.signin_link=!0),this.get("viewer")&&this.get("viewer").getValue("isPro")&&(i.stats=!0,i.get_pro_link=!1),"en-us"===this.appContext.lang.toLowerCase()&&(i.weekly_flickr=!0),this.signedOutTest&&(i.right_side_signup=!0),this.photoPrintsHelper.isPrintsEnabled()&&(i.create_link=!1,i.prints_menu=!0),this.appContext.flipper.isFlipped("enable-events-page")&&(i.events_link=!0,i.weekly_flickr=!1,i.vr_link=!1),i},isExpiringPartnerAccount:function(){var e=this.get("viewer").getValue("expiringPartner");return this.appContext.flipper.isFlipped("enable-partner-account-banner")&&e&&-1===["embedr-route","site-key-route","browser-upgrade-interstitial-route","products-marketplace-eol-route","products-account-payouts-route","error-route"].indexOf(this.appContext.routeConfig.module)},handleToastPrimaryActionClick:function(t){var i=t&&t.clickEvent?t.clickEvent.target.getAttribute("href"):null;this.setToastDismissCookie(),i?e.config.win.location.href=i:this.toastSubview.dismiss()},handleToastSecondaryActionClick:function(t){var i=t&&t.clickEvent?t.clickEvent.target.getAttribute("href"):null;this.setToastDismissCookie(),i?e.config.win.location.href=i:this.toastSubview.dismiss()},setToastDismissCookie:function(){var e=new Date;e.setTime(e.getTime()+60*this.uploadLimitDismissHours*60*1e3),this.dontSetUploadLimitDismissCookie||this.appContext.setCookie({cookieName:this.toastDismissCookieName,cookieValue:1,expires:e,path:"/"})},setProRedirectCookie:function(){var t=new Date;t.setTime(t.getTime()+60*e.config.flickr.upload_blocking.photo_limit_pro_redir_cookie_hours*60*1e3),this.appContext.setCookie({cookieName:e.config.flickr.upload_blocking.photo_limit_pro_redir_cookie_name,cookieValue:1,expires:t,path:"/"})},setupToast:function(t){var i=!1,n=!1;this.toastSubview&&(this.appContext.flipper.isFlipped("enable-upload-limit-messages")?e.UserLimitsHelper.isOverARRLimit(this.profileModel,this.appContext)?(n=!0,!t&&this.appContext.flipper.isFlipped("enable-photo-limit-overlay")&&(n="photostream-route"!==this.appContext.routeConfig.module&&"photo-route"!==this.appContext.routeConfig.module&&!this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_photo_limit_overlay_cookie_name)),!t&&this.appContext.flipper.isFlipped("enable-mega-limit-overlay")&&(n=this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_photo_limit_overlay_cookie_name)),t||(n=n&&"products-flickrpro-route"!==this.appContext.routeConfig.module),n&&(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_HEAD_FINAL"}),description:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_COPY_FINAL",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0})}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:t?this.intlMessage({intlName:"common.DISMISS"}):this.intlMessage({intlName:"common.REMIND_ME_LATER"})}),classList:["urgent"]}),this.dontSetUploadLimitDismissCookie=t,this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name,i=!0)):e.UserLimitsHelper.hasReachedUploadLimit(this.profileModel,this.appContext)&&!this.appContext.flipper.isFlipped("enable-black-friday-banner-campaign")?(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.AT_UPLOAD_LIMIT_HEAD"}),description:this.intlMessage({intlName:"upload-blocking.AT_UPLOAD_LIMIT_COPY_SHORT",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0}),limitedImagesUrl:"https://blog.flickr.net/en/2018/12/17/important-service-updates-and-dates-to-remember/?utm_campaign=flickr-launch-15&utm_source=Flickr&utm_medium=product&utm_content=big-blue",upgradeToProUrl:"/account/upgrade/pro"}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:this.intlMessage({intlName:"common.REMIND_ME_LATER"})})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name,i=!0):e.UserLimitsHelper.isNearUploadLimit(this.profileModel,this.appContext)&&!this.appContext.flipper.isFlipped("enable-black-friday-banner-campaign")&&(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.UPLOADS_LOCKED_SOON_HEAD"}),description:this.intlMessage({intlName:"upload-blocking.UPLOADS_LOCKED_SOON_COPY",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0}),limitedImagesUrl:"https://blog.flickr.net/en/2018/12/17/important-service-updates-and-dates-to-remember/?utm_campaign=flickr-launch-15&utm_source=Flickr&utm_medium=product&utm_content=big-blue",upgradeToProUrl:"/account/upgrade/pro"}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:this.intlMessage({intlName:"common.REMIND_ME_LATER"})})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name,i=!0):this.appContext.flipper.isFlipped("enable-upload-limit-warning")&&e.UserLimitsHelper.isNearUploadLimit(this.profileModel,this.appContext)&&(this.templates("upload-limit-warning")({}),this.toastSubview.setup({htmlContent:this.templates("upload-limit-warning")({})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_upload_limit_warning_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_upload_limit_warning_cookie_name,i=!0),i&&this.toastDismissCookieName&&(t||!this.appContext.getCookie(this.toastDismissCookieName))&&(this.toastSubview.show(),this.toastSubview.on("primaryActionClicked",this.handleToastPrimaryActionClick.bind(this)),this.toastSubview.on("secondaryActionClicked",this.handleToastSecondaryActionClick.bind(this))))},handlePrintClick:function(){this.photoPrintsHelper.setDismissNewBadge(),"en-us"===this.appContext.lang.toLowerCase()?this.appContext.getCookie(e.config.flickr.flickrprints.dismiss_intro_to_prints_cookie_name)?this.showPrintSelector():this.showIntroToPrintsModal():this.showEnglishPrintWarningModal()},showPrintSelector:function(){var t=this,i=this.intlMessage({intlName:"prints.CHOOSE_PHOTO_TO_GET_PRINTS"})+" "+this.intlHTMLMessage({intlName:"prints.LEARN_MORE_THEN_FEEDBACK",learnUrl:"/prints",feedbackUrl:"/help/forum/en-us/72157710589626091/"}),n=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],o=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],s=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"}],a={appContext:this.appContext,searchable:{yours:!0,contacts:!1,everyone:!1,marketplace:!1}};this.printSelector=new e.Views["photo-selector-view"](a),this.printSelectorModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!1,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:"",navBarView:new e.Views["fluid-modal-nav-bar-view"]({appContext:this.appContext,links:n,enableSearch:!0,breakpointConfig:[{maxWidth:700,links:o,enableSearch:!1},{maxWidth:500,links:s,enableSearch:!1}]}),actionButtonLabel:this.intlMessage({intlName:"prints.BUY_PRINTS"}),actionButtonDisabled:!0,subview:this.printSelector,width:Math.round(.8*Math.max(1280,e.config.win.innerWidth)),height:Math.round(e.config.win.innerHeight-60),fullWindow:!0,classList:"photo-selector",hideModalOverlay:!1,buttonFlavorText:i,flexLayout:!0}),this.printSelectorModal.show(),this.printSelectorModal.registerEventHandler(e.on("photoSelector:selected",function(e){t.printSelectorModal.enableActionButton(),t.printSelectorModal.setFlavorText(i)})),this.printSelectorModal.registerEventHandler(e.on("photoSelector:unselected",function(e){t.printSelectorModal.disableActionButton()})),this.printSelectorModal.on("actionClick",this.handleBuyPrintClick.bind(t))},handleBuyPrintClick:function(){var t=this,i=this.printSelector.get("selected");e.config.win.location.href;this.printSelectorModal.disableActionButton(!0),this.appContext.getModel("photo-models",i).then(function(i){return t.photoPrintsHelper.canPrintPhoto(i)?t.photoPrintsHelper.registerPrint(i,e.config.win.location.href):e.Promise.reject({message:"Error: Can’t print photo."})}).then(function(t){e.config.win.location.href=t.redirectURL}).catch(function(e){t.printSelectorModal.enableActionButton(),t.printSelectorModal.setFlavorText(e.message||t.intlMessage({intlName:"prints.SOMETHING_WRONG_PREPARING_PRINT"}),!0)})},showEnglishPrintWarningModal:function(t){var i=this;this.englishPrintWarningModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,showActionButton:!0,actionButtonLabel:this.intlMessage({intlName:"prints.CONTINUE_IN_ENGLISH"}),showCancelButton:!0,cancelButtonLabel:"en-us"===this.appContext.lang.toLowerCase()?this.intlMessage({intlName:"common.GO_BACK_BUTTON"}):this.intlMessage({intlName:"common.CANCEL"}),showCancelX:!1,showHeader:!0,showFooter:!0,title:this.intlMessage({intlName:"prints.ENGLISH_LANGUAGE_AHEAD"}),message:this.intlMessage({intlName:"prints.ORDERING_IS_ENGLISH_ONLY"}),hideModalOverlay:!1}),this.englishPrintWarningModal.show(),this.englishPrintWarningModal.on("actionClick",function(){setTimeout(function(){i.appContext.getCookie(e.config.flickr.flickrprints.dismiss_intro_to_prints_cookie_name)?i.showPrintSelector():i.showIntroToPrintsModal()},0)}),this.englishPrintWarningModal.on("close",function(){})},handleDrawerPageMouseDown:function(e){var t=e.target;t.ancestor(".mobile-nav-drawer",!0)||t.ancestor(".mobile-nav-toggle",!0)||this.hideMobileNavDrawer()},handleDrawerItemClick:function(e){this.hideMobileNavDrawer()},showMobileNavDrawer:function(){var t=this;this.get("container");this.contentContainer.addClass("drawer-open"),this.navDrawerShown=!0,this.navDrawer.addClass("shown"),clearTimeout(this.navDrawerOverlayHideTimeout),this.navDrawerOverlay&&(this.navDrawerOverlay.addClass("displayed"),setTimeout(function(){t.navDrawerOverlay.addClass("shown")},10)),this.drawerPageClickHandler||setTimeout(function(){t.drawerPageClickHandler=e.on(["mousedown","touchstart"],t.handleDrawerPageMouseDown.bind(t)),t.registerEventHandler(t.drawerPageClickHandler)},10)},hideMobileNavDrawer:function(){var e=this;this.get("container");this.contentContainer.removeClass("drawer-open"),this.navDrawerShown=!1,this.navDrawer.removeClass("shown"),this.navDrawerOverlay&&(this.navDrawerOverlay.removeClass("shown"),this.navDrawerOverlayHideTimeout=setTimeout(function(){e.navDrawerOverlay.removeClass("displayed")},500)),this.drawerPageClickHandler&&(this.detachRegisteredEvent(this.drawerPageClickHandler),this.drawerPageClickHandler=void 0)},prepareOrderConfirmationModal:function(){var t,i=this,n=e.QueryString.parse(e.config.win.location.search.replace("?",""));e.config.win.location.href;this.photoPrintsHelper.isPrintsEnabled()&&n&&void 0!==n.OrderID&&(t=n.OrderID,this.photoPrintsHelper.fetchOrder(t).then(function(e){i.showOrderConfirmationModal({orderId:e.orderId,orderUrl:e.orderUrl,email:e.email})}).catch(function(e){i.showOrderConfirmationModal({})}))},showOrderConfirmationModal:function(t){var i=this,n=this.templates("print-order-confirmation")({orderNum:t.orderId,orderUrl:t.orderUrl,email:t.email,helpUrl:"https://help.flickr.com/",feedbackUrl:"/help/forum"}),o=new e.Views.FluidModal({appContext:this.appContext,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showHeader:!1,showFooter:!1,showCancelX:!1,width:460,htmlMessage:n});o.show(),o.on("activated",function(){i.registerEventHandler(o.get("container").one("button.accept-button").on("click",function(){o.close()}))})},showIntroToPrintsModal:function(){var t=this,i=this.templates("intro-to-prints")({}),n=new e.Views.FluidModal({appContext:this.appContext,noScroll:!0,hideModalOverlay:!1,dismissOnOverlayClick:!0,maxHeight:!1,showHeader:!1,showFooter:!1,width:450,contentPadding:0,showCancelX:!0,htmlMessage:i});n.show(),n.on("activated",function(){n.get("container").one(".accept-button").on("click",function(e){n.close()})}),n.on("close",function(){var i=new Date;i.setTime(i.getTime()+36e10),t.appContext.setCookie({cookieName:e.config.flickr.flickrprints.dismiss_intro_to_prints_cookie_name,cookieValue:1,expires:i,path:"/"}),setTimeout(function(){t.showPrintSelector()},0)})},destructor:function(){clearTimeout(this.signUpInterstitialTimer),e.AnchorRepositioner.removeOffset(t)}})},"@VERSION@",{
requires:["flickr-view","hermes-template-global-nav","hermes-template-feedback-modal-view","hermes-template-upload-limit-warning","hermes-template-upload-limit-message","hermes-template-print-order-confirmation","hermes-template-intro-to-prints","search-url","search-autosuggest-field-view","querystring-parse-simple","querystring-stringify-simple","notifications-menu-view","url-helper","person-menu-view","group-menu-view","browser-support","fluid-modal-view","signup-modal-view","signup-interstitial-view","signin-helper","storage-helper","partner-account-banner-view","featured-toast-view","user-limits-helper","photo-selector-view","fluid-modal-nav-bar-view","banner-view","photo-prints-helper","math-helper","banner-helper"],langBundles:["global-nav","common","search","upload-blocking","prints","blurb","thanks"]});